---
title: Autorisations de fichier
description: Comprendre comment WSL détermine les autorisations de fichier dans Windows
keywords: BashOnWindows, bash, wsl, wsl2, windows, sous-système windows pour linux, sous-système windows, ubuntu, debian, suse, windows 10, fichier, autorisations
ms.date: 01/14/2020
ms.topic: article
ms.assetid: 7afaeacf-435a-4e58-bff0-a9f0d75b8a51
ms.localizationpriority: high
ms.openlocfilehash: 81d4cfa1ae57cdd077ba8cbd614111881724718a
ms.sourcegitcommit: f1b049a1276782d4f2754f46a8d2025b598a0784
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/24/2020
ms.locfileid: "85336072"
---
# <a name="file-permissions-for-wsl"></a><span data-ttu-id="9eee7-104">Autorisations de fichier pour WSL</span><span class="sxs-lookup"><span data-stu-id="9eee7-104">File Permissions for WSL</span></span>

<span data-ttu-id="9eee7-105">Cette page explique en détail comment les autorisations de fichier Linux sont interprétées dans le sous-système Windows pour Linux, en particulier lors de l’accès à des ressources dans Windows, dans le système de fichiers NT.</span><span class="sxs-lookup"><span data-stu-id="9eee7-105">This page details how Linux file permissions are interpreted across the Windows Subsystem for Linux, especially when accessing resources inside of Windows on the NT file system.</span></span> <span data-ttu-id="9eee7-106">Cette documentation suppose d’avoir compris les bases de la [structure des autorisations du système de fichiers Linux](https://wiki.archlinux.org/index.php/File_permissions_and_attributes) et de la [commande umask](https://en.wikipedia.org/wiki/Umask).</span><span class="sxs-lookup"><span data-stu-id="9eee7-106">This documentation assumes a basic understanding of the [Linux file system permissions structure](https://wiki.archlinux.org/index.php/File_permissions_and_attributes) and the [umask command](https://en.wikipedia.org/wiki/Umask).</span></span>

<span data-ttu-id="9eee7-107">Lors de l’accès à des fichiers Windows à partir de WSL, les autorisations de fichier sont calculées à partir des autorisations Windows ou lues à partir des métadonnées qui ont été ajoutées au fichier par WSL.</span><span class="sxs-lookup"><span data-stu-id="9eee7-107">When accessing Windows files from WSL the file permissions are either calculated from Windows permissions, or are read from metadata that has been added to the file by WSL.</span></span> <span data-ttu-id="9eee7-108">Ces métadonnées ne sont pas activées par défaut.</span><span class="sxs-lookup"><span data-stu-id="9eee7-108">This metadata is not enabled by default.</span></span>

## <a name="wsl-metadata-on-windows-files"></a><span data-ttu-id="9eee7-109">Métadonnées WSL sur les fichiers Windows</span><span class="sxs-lookup"><span data-stu-id="9eee7-109">WSL metadata on Windows files</span></span>

<span data-ttu-id="9eee7-110">Lorsque les métadonnées sont activées comme option de montage dans WSL, des attributs étendus sur les fichiers Windows NT peuvent être ajoutés et interprétés pour fournir des autorisations de système de fichiers Linux.</span><span class="sxs-lookup"><span data-stu-id="9eee7-110">When metadata is enabled as a mount option in WSL, extended attributes on Windows NT files can be added and interpreted to supply Linux file system permissions.</span></span>

<span data-ttu-id="9eee7-111">WSL peut ajouter quatre attributs étendus NTFS :</span><span class="sxs-lookup"><span data-stu-id="9eee7-111">WSL can add four NTFS extended attributes:</span></span>

| <span data-ttu-id="9eee7-112">Nom d’attribut</span><span class="sxs-lookup"><span data-stu-id="9eee7-112">Attribute Name</span></span> | <span data-ttu-id="9eee7-113">Description</span><span class="sxs-lookup"><span data-stu-id="9eee7-113">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9eee7-114">$LXUID</span><span class="sxs-lookup"><span data-stu-id="9eee7-114">$LXUID</span></span> | <span data-ttu-id="9eee7-115">ID d’utilisateur propriétaire</span><span class="sxs-lookup"><span data-stu-id="9eee7-115">User Owner ID</span></span> |
| <span data-ttu-id="9eee7-116">$LXGID</span><span class="sxs-lookup"><span data-stu-id="9eee7-116">$LXGID</span></span> | <span data-ttu-id="9eee7-117">ID de groupe propriétaire</span><span class="sxs-lookup"><span data-stu-id="9eee7-117">Group Owner ID</span></span> |
| <span data-ttu-id="9eee7-118">$LXMOD</span><span class="sxs-lookup"><span data-stu-id="9eee7-118">$LXMOD</span></span> | <span data-ttu-id="9eee7-119">Mode fichier (octaux et type d’autorisation des systèmes de fichiers, p. ex. : 0777)</span><span class="sxs-lookup"><span data-stu-id="9eee7-119">File mode (File systems permission octals and type, e.g: 0777)</span></span> |
| <span data-ttu-id="9eee7-120">$LXDEV</span><span class="sxs-lookup"><span data-stu-id="9eee7-120">$LXDEV</span></span> | <span data-ttu-id="9eee7-121">Appareil, s’il s’agit d’un fichier d’appareil</span><span class="sxs-lookup"><span data-stu-id="9eee7-121">Device, if it is a device file</span></span> |

<span data-ttu-id="9eee7-122">De plus, tout fichier qui n’est pas un fichier ou un répertoire standard (p. ex. : liens symboliques, FIFO, périphériques de traitement par blocs, sockets Unix et périphériques d’entrée-sortie de caractères) a également un [point d’analyse](https://docs.microsoft.com/windows/win32/fileio/reparse-points) NTFS.</span><span class="sxs-lookup"><span data-stu-id="9eee7-122">Additionally, any file that is not a regular file or directory (e.g: symlinks, FIFOs, block devices, unix sockets, and character devices) also have an NTFS [reparse point](https://docs.microsoft.com/windows/win32/fileio/reparse-points).</span></span> <span data-ttu-id="9eee7-123">Il est ainsi beaucoup plus rapide de déterminer le type de fichier figurant dans un répertoire donné sans avoir à interroger ses attributs étendus.</span><span class="sxs-lookup"><span data-stu-id="9eee7-123">This makes it much faster to determine the kind of file in a given directory without having to query its extended attributes.</span></span>

## <a name="file-access-scenarios"></a><span data-ttu-id="9eee7-124">Scénarios d’accès aux fichiers</span><span class="sxs-lookup"><span data-stu-id="9eee7-124">File Access Scenarios</span></span>

<span data-ttu-id="9eee7-125">Vous trouverez ci-dessous une description de la façon dont les autorisations sont déterminées lors de l’accès aux fichiers de différentes manières à l’aide du sous-système Windows pour Linux.</span><span class="sxs-lookup"><span data-stu-id="9eee7-125">Below is a description of how permissions are determined when accessing files in different ways using the Windows Subsystem for Linux.</span></span>

### <a name="accessing-files-in-the-windows-drive-file-system-drvfs-from-linux"></a><span data-ttu-id="9eee7-126">Accès aux fichiers dans le système de fichiers du lecteur Windows (DrvFS) à partir de Linux</span><span class="sxs-lookup"><span data-stu-id="9eee7-126">Accessing Files in the Windows drive file system (DrvFS) from Linux</span></span>

<span data-ttu-id="9eee7-127">Ces scénarios surviennent lorsque vous accédez à vos fichiers Windows à partir de WSL, probablement via `/mnt/c`.</span><span class="sxs-lookup"><span data-stu-id="9eee7-127">These scenarios occur when you are accessing your Windows files from WSL, most likely via `/mnt/c`.</span></span>

#### <a name="reading-file-permissions-from-an-existing-windows-file"></a><span data-ttu-id="9eee7-128">Lecture des autorisations de fichier à partir d’un fichier Windows existant</span><span class="sxs-lookup"><span data-stu-id="9eee7-128">Reading file permissions from an existing Windows file</span></span>

<span data-ttu-id="9eee7-129">Le résultat dépend du fait que le fichier a ou non déjà des métadonnées existantes.</span><span class="sxs-lookup"><span data-stu-id="9eee7-129">The result depends on if the file already has existing metadata.</span></span>

##### <a name="drvfs-file-does-not-have-metadata-default"></a><span data-ttu-id="9eee7-130">Le fichier DrvFS n’a pas de métadonnées (par défaut)</span><span class="sxs-lookup"><span data-stu-id="9eee7-130">DrvFS file does not have metadata (default)</span></span>

<span data-ttu-id="9eee7-131">Si le fichier n’a pas de métadonnées associées, nous traduisons les autorisations effectives de l’utilisateur Windows en bits de lecture/écriture/exécution et leur attribuons la même valeur pour l’utilisateur, le groupe et autre.</span><span class="sxs-lookup"><span data-stu-id="9eee7-131">If the file has no metadata associated with it then we translate the effective permissions of the Windows user to read/write/execute bits and set them to the this as the same value for user, group, and other.</span></span> <span data-ttu-id="9eee7-132">Par exemple, si votre compte d’utilisateur Windows dispose d’un accès en lecture et exécution, mais pas d’un accès en écriture au fichier, cela sera indiqué sous la forme `r-x` pour l’utilisateur, le groupe et autre.</span><span class="sxs-lookup"><span data-stu-id="9eee7-132">For example, if your Windows user account has read and execute access but not write access to the file then this will be shown as `r-x` for user, group and other.</span></span> <span data-ttu-id="9eee7-133">Si l’attribut « Lecture seule » du fichier est défini dans Windows, nous n’accordons pas l’accès en écriture dans Linux.</span><span class="sxs-lookup"><span data-stu-id="9eee7-133">If the file has the 'Read Only' attribute set in Windows then we do not grant write access in Linux.</span></span>

##### <a name="the-file-has-metadata"></a><span data-ttu-id="9eee7-134">Le fichier a des métadonnées</span><span class="sxs-lookup"><span data-stu-id="9eee7-134">The file has metadata</span></span>

<span data-ttu-id="9eee7-135">Si le fichier a des métadonnées, nous utilisons simplement ces valeurs de métadonnées au lieu de traduire les autorisations effectives de l’utilisateur Windows.</span><span class="sxs-lookup"><span data-stu-id="9eee7-135">If the file has metadata present, we simply use those metadata values instead of translating effective permissions of the Windows user.</span></span>

#### <a name="changing-file-permissions-on-an-existing-windows-file-using-chmod"></a><span data-ttu-id="9eee7-136">Modification des autorisations de fichier d’un fichier Windows existant à l’aide de chmod</span><span class="sxs-lookup"><span data-stu-id="9eee7-136">Changing file permissions on an existing Windows file using chmod</span></span>

<span data-ttu-id="9eee7-137">Le résultat dépend du fait que le fichier a ou non déjà des métadonnées existantes.</span><span class="sxs-lookup"><span data-stu-id="9eee7-137">The result depends on if the file already has existing metadata.</span></span>

##### <a name="chmod-file-does-not-have-metadata-default"></a><span data-ttu-id="9eee7-138">Le fichier chmod n’a pas de métadonnées (par défaut)</span><span class="sxs-lookup"><span data-stu-id="9eee7-138">chmod file does not have metadata (default)</span></span>

<span data-ttu-id="9eee7-139">Chmod aura un seul effet. Si vous supprimez tous les attributs d’écriture d’un fichier, l’attribut « lecture seule » du fichier Windows est défini, car il s’agit du même comportement que celui du système CIFS (Common Internet File System) qui est le client SMB (Server Message Block) dans Linux.</span><span class="sxs-lookup"><span data-stu-id="9eee7-139">Chmod will only have one effect, if you remove all the write attributes of a file then the 'read only' attribute on the Windows file will be set, since this is the same behaviour as CIFS (Common Internet File System) which is the SMB (Server Message Block) client in Linux.</span></span>

##### <a name="chmod-file-has-metadata"></a><span data-ttu-id="9eee7-140">Le fichier chmod a des métadonnées</span><span class="sxs-lookup"><span data-stu-id="9eee7-140">chmod file has metadata</span></span>

<span data-ttu-id="9eee7-141">Chmod change ou ajoute des métadonnées en fonction des métadonnées déjà existantes du fichier.</span><span class="sxs-lookup"><span data-stu-id="9eee7-141">Chmod will change or add metadata depending on the file's already existing metadata.</span></span> 

<span data-ttu-id="9eee7-142">N’oubliez pas que vous ne pouvez pas vous accorder plus d’accès que ce que vous avez sur Windows, même si les métadonnées indiquent que vous le pouvez.</span><span class="sxs-lookup"><span data-stu-id="9eee7-142">Please keep in mind that you cannot give yourself more access than what you have on Windows, even if the metadata says that is the case.</span></span> <span data-ttu-id="9eee7-143">Par exemple, vous pouvez définir les métadonnées pour qu’elles affichent que vous disposez d’autorisations en écriture à un fichier à l’aide de `chmod 777`, mais si vous tentez d’accéder à ce fichier, vous ne pourrez toujours pas écrire dedans.</span><span class="sxs-lookup"><span data-stu-id="9eee7-143">For example, you could set the metadata to display that you have write permissions to a file using `chmod 777`, but if you tried to access that file you would still not be able to write to it.</span></span> <span data-ttu-id="9eee7-144">Cela est dû à l’interopérabilité, car les commandes de lecture et d’écriture des fichiers Windows sont routées via vos autorisations d’utilisateur Windows.</span><span class="sxs-lookup"><span data-stu-id="9eee7-144">This is thanks to interopability, as any read or write commands to Windows files are routed through your Windows user permissions.</span></span>

#### <a name="creating-a-file-in-drivefs"></a><span data-ttu-id="9eee7-145">Création d’un fichier dans DriveFS</span><span class="sxs-lookup"><span data-stu-id="9eee7-145">Creating a file in DriveFS</span></span>

<span data-ttu-id="9eee7-146">Le résultat dépend de l’activation ou non des métadonnées.</span><span class="sxs-lookup"><span data-stu-id="9eee7-146">The result depends on if metadata is enabled.</span></span>

##### <a name="metadata-is-not-enabled-default"></a><span data-ttu-id="9eee7-147">Les métadonnées ne sont pas activées (par défaut)</span><span class="sxs-lookup"><span data-stu-id="9eee7-147">Metadata is not enabled (default)</span></span>

<span data-ttu-id="9eee7-148">Les autorisations Windows du fichier nouvellement créé sont les mêmes que si vous avez créé le fichier dans Windows sans un descripteur de sécurité spécifique. Il hérite des autorisations du parent.</span><span class="sxs-lookup"><span data-stu-id="9eee7-148">The Windows permissions of the newly created file will be the same as if you created the file in Windows without a specific security descriptor, it will inherit the parent's permissions.</span></span>

##### <a name="metadata-is-enabled"></a><span data-ttu-id="9eee7-149">Les métadonnées sont activées</span><span class="sxs-lookup"><span data-stu-id="9eee7-149">Metadata is enabled</span></span>

<span data-ttu-id="9eee7-150">Les bits d’autorisation de fichier sont définis de façon à suivre le masque umask Linux, et le fichier est enregistré avec les métadonnées.</span><span class="sxs-lookup"><span data-stu-id="9eee7-150">The file's permission bits are set to follow the Linux umask, and the file will be saved with metadata.</span></span>

#### <a name="which-linux-user-and-linux-group-owns-the-file"></a><span data-ttu-id="9eee7-151">Quel utilisateur Linux et quel groupe Linux le fichier détient-il ?</span><span class="sxs-lookup"><span data-stu-id="9eee7-151">Which Linux user and Linux group owns the file?</span></span> 

<span data-ttu-id="9eee7-152">Le résultat dépend du fait que le fichier a ou non déjà des métadonnées existantes.</span><span class="sxs-lookup"><span data-stu-id="9eee7-152">The result depends on if the file already has existing metadata.</span></span>

##### <a name="user-file-does-not-have-metadata-default"></a><span data-ttu-id="9eee7-153">Le fichier utilisateur n’a pas de métadonnées (par défaut)</span><span class="sxs-lookup"><span data-stu-id="9eee7-153">User file does not have metadata (default)</span></span>

<span data-ttu-id="9eee7-154">Dans le scénario par défaut, lors du montage automatique de lecteurs Windows, nous spécifions que l’ID d’utilisateur (UID) de tous les fichiers est défini sur l’ID d’utilisateur (UID) de votre utilisateur WSL et que l’ID de groupe (GID) est défini sur l’ID de groupe principal de votre utilisateur WSL.</span><span class="sxs-lookup"><span data-stu-id="9eee7-154">In the default scenario, when automounting Windows drives, we specify that the user ID (UID) for any file is set to the user ID of your WSL user and the group ID (GID) is set to the principal group ID of your WSL user.</span></span>

##### <a name="user-file-has-metadata"></a><span data-ttu-id="9eee7-155">Le fichier utilisateur a des métadonnées</span><span class="sxs-lookup"><span data-stu-id="9eee7-155">User file has metadata</span></span>

<span data-ttu-id="9eee7-156">Les identificateurs UID et GID spécifiés dans les métadonnées sont appliqués en tant qu’utilisateur propriétaire et groupe propriétaire du fichier.</span><span class="sxs-lookup"><span data-stu-id="9eee7-156">The UID and GID specified in the metadata is applied as the user owner and group owner of the file.</span></span>

### <a name="accessing-linux-files-from-windows-using-wsl"></a><span data-ttu-id="9eee7-157">Accès aux fichiers Linux à partir de Windows à l’aide de `\\wsl$`</span><span class="sxs-lookup"><span data-stu-id="9eee7-157">Accessing Linux files from Windows using `\\wsl$`</span></span>

<span data-ttu-id="9eee7-158">L’accès aux fichiers Linux via `\\wsl$` utilise l’utilisateur par défaut de votre distribution WSL.</span><span class="sxs-lookup"><span data-stu-id="9eee7-158">Accessing Linux files via `\\wsl$` will use the default user of your WSL distribution.</span></span> <span data-ttu-id="9eee7-159">Par conséquent, toute application Windows accédant à des fichiers Linux aura les mêmes autorisations que l’utilisateur par défaut.</span><span class="sxs-lookup"><span data-stu-id="9eee7-159">Therefore any Windows app accessing Linux files will have the same permissions as the default user.</span></span>

#### <a name="creating-a-new-file"></a><span data-ttu-id="9eee7-160">Création d’un nouveau fichier</span><span class="sxs-lookup"><span data-stu-id="9eee7-160">Creating a new file</span></span>

<span data-ttu-id="9eee7-161">Le masque umask par défaut est appliqué lors de la création d’un nouveau fichier à l’intérieur d’une distribution WSL à partir de Windows.</span><span class="sxs-lookup"><span data-stu-id="9eee7-161">The default umask is applied when creating a new file inside of a WSL distribution from Windows.</span></span> <span data-ttu-id="9eee7-162">Le masque umask par défaut est `022`. En d’autres termes, il autorise toutes les autorisations, à l’exception des autorisations en écriture sur les groupes et autres.</span><span class="sxs-lookup"><span data-stu-id="9eee7-162">The default umask is `022`, or in other words it allows all permissions except write permissions to groups and others.</span></span> 

### <a name="accessing-files-in-the-linux-root-file-system-from-linux"></a><span data-ttu-id="9eee7-163">Accès aux fichiers dans le système de fichiers racine Linux à partir de Linux</span><span class="sxs-lookup"><span data-stu-id="9eee7-163">Accessing files in the Linux root file system from Linux</span></span>

<span data-ttu-id="9eee7-164">Tous les fichiers créés, modifiés ou consultés dans le système de fichiers racine Linux suivent les conventions Linux standard, telles que l’application du masque umask à un fichier nouvellement créé.</span><span class="sxs-lookup"><span data-stu-id="9eee7-164">Any files created, modified, or accessed in the Linux root file system follow standard Linux conventions, such as applying the umask to a newly created file.</span></span>

## <a name="configuring-file-permissions"></a><span data-ttu-id="9eee7-165">Configuration des autorisations de fichier</span><span class="sxs-lookup"><span data-stu-id="9eee7-165">Configuring file permissions</span></span>

<span data-ttu-id="9eee7-166">Vous pouvez configurer vos autorisations de fichier à l’intérieur de vos lecteurs Windows à l’aide des options de montage figurant dans wsl.conf.</span><span class="sxs-lookup"><span data-stu-id="9eee7-166">You can configure your file permissions inside of your Windows drives using the mount options in wsl.conf.</span></span> <span data-ttu-id="9eee7-167">Les options de montage vous permettent de définir des masques d’autorisations `umask`, `dmask` et `fmask`.</span><span class="sxs-lookup"><span data-stu-id="9eee7-167">The mount options allow you to set `umask`, `dmask` and `fmask` permissions masks.</span></span> <span data-ttu-id="9eee7-168">Le masque `umask` est appliqué à tous les fichiers, le masque `dmask` est appliqué uniquement aux répertoires et le masque `fmask` est appliqué uniquement aux fichiers.</span><span class="sxs-lookup"><span data-stu-id="9eee7-168">The `umask` is applied to all files, the `dmask` is applied just to directories and the `fmask` is applied just to files.</span></span> <span data-ttu-id="9eee7-169">Ces masques d’autorisations passent ensuite par une opération OR logique lorsqu’ils sont appliqués aux fichiers, p. ex. : Si vous avez une valeur `umask` de `023` et une valeur `fmask` de `022`, le masque d’autorisations résultant pour les fichiers sera `023`.</span><span class="sxs-lookup"><span data-stu-id="9eee7-169">These permission masks are then put through a logical OR operation when being applied to files, e.g: If you have a `umask` value of `023` and an `fmask` value of `022` then the resulting permissions mask for files will be `023`.</span></span>

<span data-ttu-id="9eee7-170">Pour obtenir des instructions sur la procédure à suivre, consultez l’article [Configurer les paramètres de lancement par distribution avec wslconf](./wsl-config.md#configure-per-distro-launch-settings-with-wslconf).</span><span class="sxs-lookup"><span data-stu-id="9eee7-170">Please see the [Configure per distro launch settings with wslconf](./wsl-config.md#configure-per-distro-launch-settings-with-wslconf) article for instructions on how to do this.</span></span>
